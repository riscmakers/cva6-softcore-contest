Refactor data cache and simplify some of its mechanics
